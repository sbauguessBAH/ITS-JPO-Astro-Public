---
const { pathname } = Astro.url;
const { currentTitle } = Astro.props; // Receive the custom title

const segments = pathname.split('/').filter(Boolean);
const breadcrumbs = segments.map((segment, index) => {
  const href = `/${segments.slice(0, index + 1).join('/')}`;
  const isLast = index === segments.length - 1;

  // If it's the last item and we passed a title, use it. 
  // Otherwise, format the URL slug.
  const label = (isLast && currentTitle) 
    ? currentTitle 
    : segment.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase());

  return { label, href, isLast };
});
---

<nav aria-label="Breadcrumb" class="breadcrumbs">
  <ol>
    <li>
      <a href="/">Home</a>
    </li>
    
    {breadcrumbs.map((crumb, index) => (
      <li>
        <span class="separator" aria-hidden="true">/</span>
        {index === breadcrumbs.length - 1 ? (
          <span class="current" aria-current="page">{crumb.label}</span>
        ) : (
          <a href={crumb.href}>{crumb.label}</a>
        )}
      </li>
    ))}
  </ol>
</nav>

<style>
  .breadcrumbs ol {
    list-style: none;
    display: flex;
    gap: 0.5rem;
    padding: 0;
    margin: 1rem 0;
    font-family: sans-serif;
  }

  .breadcrumbs li {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .breadcrumbs a {
    color: #0066cc;
    text-decoration: none;
  }

  .breadcrumbs a:hover {
    text-decoration: underline;
  }

  .breadcrumbs .separator {
    color: #666;
    user-select: none;
  }

  .breadcrumbs .current {
    color: #333;
    font-weight: bold;
  }
</style>