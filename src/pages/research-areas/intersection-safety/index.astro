---
import ProgramSection from "@/src/components/programs/ProgramSection.astro";
import Layout from "./_layout.astro";
import Card from "@/src/components/programs/card/Card.astro";
import CardHeader from "@/src/components/programs/card/CardHeader.astro";
import CardBody from "@/src/components/programs/card/CardBody.astro";
import Link from "@/src/components/Link.astro";
import intersectionCrashesImage from "@/src/assets/images/intersection-safety/intersection-crashes.png";
import userDeathsImage from "@/src/assets/images/intersection-safety/user-deaths.png";
import { Image } from "astro:assets";
import CardFooter from "@/src/components/programs/card/CardFooter.astro";
import OverlayCard, { type OverlayResource } from "@/src/components/programs/OverlayCard.astro";
import iscLogo from "@/src/assets/images/intersection-safety/isc-logo.png";
import issLogo from "@/src/assets/images/intersection-safety/iss-logo.png";
import issBackground from "@/src/assets/images/intersection-safety/iss-background.png";
import iscBackground from "@/src/assets/images/intersection-safety/isc-background.jpg";
import base_url from "@/src/lib/base_url";
import plusIcon from "@/src/assets/images/intersection-safety/plus.png";
import equalsIcon from "@/src/assets/images/intersection-safety/equals.png";
import dataFusionIcon from "@/src/assets/images/intersection-safety/data-fusion.png";
import aiIcon from "@/src/assets/images/intersection-safety/ai.png";
import integrationIcon from "@/src/assets/images/intersection-safety/integration.png";
import safeIntersectionImage from "@/src/assets/images/intersection-safety/safe-intersection.jpg";
import BoxArrowUpRightIcon from "@/src/components/programs/icons/BoxArrowUpRightIcon.astro";
import PdfIcon from "@/src/components/programs/icons/PdfIcon.astro";
import FilmIcon from "@/src/components/programs/icons/FilmIcon.astro";

---
<style>
  .overview-section {
    display: flex;
    flex-direction: column;
    gap: var(--size-lg);
  }
  .overview-image {
    border-radius: var(--border-radius);
  }

  @media (min-width: 992px) {
    .overview-section {
      flex-direction: row;
      align-items: center;
    }
    .overview-image {
      flex-basis: 40%;
    }
    .overview-text {
      flex-basis: 60%;
    }
  }
</style>
<style>
  .vision-container {
    background: rgb(var(--color-gray-light));
    border-radius: var(--radius-md);
    padding: 2rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
</style>
<style>
  .problem-container {
    display: grid;
    grid-template-columns: repeat(1, 1fr);
    gap: var(--size);
  }

  .problem {
    display: flex;
    flex-direction: column;
    gap: var(--size);
    padding: var(--size-xs);
    align-items: center;
  }

  .problem-image {
    max-width: 200px;
  }

  @media (min-width: 1200px) {
    .problem-container {
      grid-template-columns: repeat(2, 1fr);
    }

    .problem {
      flex-direction: row;
      align-items: center;
    }

    .problem-content {
      flex-basis: 70%;
    }

    .problem-image {
      flex-basis: 30%;
      padding: 0.5rem;
      height: auto;
    }
  }
</style>
<style>
  .stage-container {
    display: grid;
    grid-template-columns: repeat(1, 1fr);
    /* gap: var(--size); */
  }

  .stage-image {
    padding: var(--size)
  }

  @media (min-width: 1200px) {
    .stage-container {
      grid-template-columns: repeat(2, 1fr);
    }

    .stage {
      display: flex;
      flex-direction: column;
    }

    .stage-image {
      height: 200px;
      width: auto;
    }

    .stage-content {

    }
    .stage-left {
      padding-right: var(--size);
      border-right: 1px solid var(--border-light);
    }

    .stage-right {
      padding-left: var(--size);
    }
  }
</style>
<style>
  .resource-container {
    display: grid;
    grid-template-columns: repeat(1, 1fr);
    gap: var(--size);
  }

  .resource-card-header {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
  }
  .resource-card-title {
    text-transform: none;
  }
  .resource-card-subtitle {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
  }
  .resource-button {
    border: 1px solid #dee2e6;
    padding: 0.2rem 0.5rem;
    display: inline-block;
    text-align: center;
    text-decoration: none;
    gap: 1rem;
    justify-content: center;
    align-items: center;
    font-size: 0.9rem;
    font-weight: 600;
    color: black;
    border-radius: var(--radius-sm);
    transition: all var(--transition-duration) ease-in-out;
  }
  .resource-button::after {
    content: "";
  }
  .resource-button:hover {
    font-weight: 600;
    background: #dee2e6;
  }

  @media (min-width: 1200px) {
    .resource-container {
      grid-template-columns: repeat(3, 1fr);
    }
  }
</style>
<style>
  .solution-container {
    display: flex;
    flex-direction: column;
    gap: var(--size);
    align-items: center;
  }

  .solution-symbol {
    width: 50px;
  }

  .solution-icon {
    max-width: 200px;
  }

  .solution-header {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .solution-card {
    padding: var(--size);
  }

  @media (min-width: 1200px) {
    .solution-container {
      display: grid;
      grid-template-columns: 1fr 0.1fr 1fr 0.1fr 1fr;
      grid-auto-rows: 1fr;
      gap: var(--size);
    }

    .solution-symbol {
      display: flex;
      align-items: center;
      justify-content: center;
      
    }

    .solution-card {
      height: 100%;
    }
  }
</style>
<Layout>
  <main class="program-main">
    <ProgramSection>
      <div class="overview-section">
        <div class="overview-text">
          <h2 class="program-title-lg">
            Overview
          </h2>
          <p class="program-text">
            The USDOT aims to transform intersection safety by incentivizing the innovative application 
            of emerging technologies to identify and mitigate unsafe conditions involving vehicles and vulnerable road users 
            at intersections. This initiative, which is specifically focused on the use of technology, 
            complements other federal efforts to improve intersection safety.
            The intersection environment is well-suited to innovative mitigative approaches that leverage and potentially repurpose
            existing traffic control and support infrastructure.
          </p>
        </div>
        <div class="overview-image">
          <Image src={safeIntersectionImage} alt="Safe Intersection Image" class="img-fluid radius-md shadow" />
        </div>
      </div>
      <div class="vision-container mt-5">
        <h3 class="program-title-md mb-0 text-center">Vision</h3>
        <p class="program-text max-w-lg text-center mx-auto">
          <strong>Transform intersection safety</strong> through the innovative application 
          of emerging technologies including machine vision, sensor fusion, 
          and real-time decision-making to identify and mitigate unsafe conditions 
          involving vehicles and vulnerable road users at intersections.
        </p>
      </div>
    </ProgramSection>
    <ProgramSection color="gray">
      <h2 class="program-title-lg text-center">
        Addressing the Problem
      </h2>
      <p class="program-text text-center max-w-lg mx-auto">
        Intersection safety is a growing issue, especially for vulnerable road users.
      </p>
      <div class="problem-container mt-4">
        <Card shadow="sm">
          <CardBody>
            <div class="problem">
              <div class="problem-image">
                <Image src={intersectionCrashesImage} alt="Intersection Crashes Icon" class="img-fluid" />
              </div>
              <div class="problem-content">
                <h3 class="program-title-md">
                  Intersection Crashes
                </h3>
                <p class="program-text">
                  Each year roughly one-quarter of traffic fatalities and about one-half 
                  of all traffic injuries in the United States are attributed 
                  to intersections <Link href="https://highways.dot.gov/safety/intersection-safety/about" isExternal>(FHWA Safety)</Link>.
                </p>
              </div>
            </div>
          </CardBody>
        </Card>
        <Card shadow="sm">
          <CardBody>
            <div class="problem">
              <div class="problem-image">
                <Image src={userDeathsImage} alt="User Deaths Icon" class="img-fluid" />
              </div>
              <div class="problem-content">
                <h3 class="program-title-md">
                  Rising Vulnerable Road User Deaths
                </h3>
                <p class="program-text">
                  Vulnerable road user fatalities are on the rise with pedestrian fatalities 
                  in 2022 (7,522) at the highest level since 1981, and increasing significantly since 2013 (4,779).
                  <Link href="https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/813661" isExternal>(NHTSA)</Link>.
                </p>
              </div>
            </div>
          </CardBody>
        </Card>
      </div>
    </ProgramSection>
    <ProgramSection color="gray">
      <h2 class="program-title-lg text-center">
        Proposing a Solution
      </h2>
      <p class="program-text text-center max-w-lg mx-auto">
        Accelerate intersection safety deployments nationwide with Artificial Intelligence (AI).
      </p>
      <div class="solution-container mt-4">
        <Card class="solution-card" shadow="sm">
          <CardHeader class="solution-header">
            <Image src={dataFusionIcon} alt="Data Fusion Icon" class="img-fluid solution-icon" />
          </CardHeader>
          <CardBody>
            <h3 class="program-title-md">
              Data Fusion Utilizing Existing and Emerging Sensors
            </h3>
          </CardBody>
          <CardFooter>
            <p class="program-text">
              Emerging, low-cost sensors can be deployed at intersections for 
              <strong>improved sensing of vulnerable road users</strong>. Data 
              from these sensors can be fused and used in new ways by AI.
            </p>
          </CardFooter>
        </Card>
        <div class="solution-symbol">
          <Image src={plusIcon} alt="Plus Icon" class="img-fluid" />
        </div>
          <Card class="solution-card" shadow="sm">
            <CardHeader class="solution-header">
              <Image src={aiIcon} alt="AI Icon" class="img-fluid solution-icon" />
            </CardHeader>
            <CardBody>
              <h3 class="program-title-md">
                Artificial Intelligence and Machine Learning
              </h3>
            </CardBody>
            <CardFooter>
              <p class="program-text">
                AI/ML can fuse data from multiple machine vision sensing modalities 
                rapidly to <strong>improve situational awareness</strong> and 
                <strong>anticipate potential conflicts</strong>.
              </p>
            </CardFooter>
          </Card>
        <div class="solution-symbol">
          <Image src={equalsIcon} alt="Equals Icon" class="img-fluid" />
        </div>
          <Card class="solution-card" shadow="sm">
            <CardHeader class="solution-header">
              <Image src={integrationIcon} alt="Integration Icon" class="img-fluid solution-icon" />
            </CardHeader>
            <CardBody>
              <h3 class="program-title-md">
                Low-Cost, High-Value Opportunity for Integration at Scale
              </h3>
            </CardBody>
            <CardFooter>
              <p class="program-text">
                These existing technologies have not been deployed together 
                at intersections broadly, offering an opportunity ripe 
                for <strong>innovative collaboration</strong>.
              </p>
            </CardFooter>
          </Card>
      </div>
    </ProgramSection>
    <ProgramSection>
      <h2 class="program-title-lg">
        Initiatives
      </h2>
      <p class="program-text">
        AI innovation could make our nation's intersections safer for all road users.
      </p>
      <div class="stage-container mt-4">
        <div class="stage stage-left">
          <div class="stage-image">
            <Image src={iscLogo} alt="Intersection Safety Challenge Logo" class="img-fluid" />
          </div>
          <div class="stage-content">
            <p class="program-text">
              Multiple teams competed against each other utilizing sensor fustion and machine learning algorithms 
              to detect, localize, and classify vulnerable road users and vehicles.
            </p>
            <a class="program-button" href={base_url("/research-areas/intersection-safety/challenge")}>
              Learn More
            </a>
          </div>
        </div>
        <div class="stage stage-right">
          <div class="stage-image">
            <Image src={issLogo} alt="Intersection Safety Challenge Logo" class="img-fluid" />
          </div>
          <div class="stage-content">
            <p class="program-text">
              The Intersection Safety Systems (ISS) initiative is focused on full end-to-end
              prototype development and testing of systems that can improve intersection safety
              using technologies described above, including sensor fusion, AI-based decision-making,
              and conflict mitigation.
            </p>
            <a class="program-button" href={base_url("/research-areas/intersection-safety/prototype")}>
              Learn More
            </a>
          </div>
        </div>
      </div>
    </ProgramSection>
    <ProgramSection>
      <h2 class="program-title-lg">
        Additional Resources
      </h2>
      <div class="resource-container">
        <Card shadow="sm">
          <CardHeader>
            <div class="resource-card-header p-2">
              <h3 class="resource-card-title">Enhancing the Safety of Vulnerable Road Users at Intersections</h3>
              <p class="resource-card-subtitle">February 2023</p>
            </div>
          </CardHeader>
          <CardBody>
            <div class="p-2 d-flex gap-2">
              <a 
                class="resource-button" 
                href="https://rosap.ntl.bts.gov/view/dot/66622" 
                rel="noopener noreferrer" 
                target="_blank"
              >
                <BoxArrowUpRightIcon size={12} />
                Summary Report
              </a>
              <a 
                class="resource-button" 
                href="https://www.federalregister.gov/documents/2022/09/16/2022-20188/enhancing-the-safety-of-vulnerable-road-users-at-intersections-request-for-information" 
                rel="noopener noreferrer" 
                target="_blank"
              >
                <BoxArrowUpRightIcon size={12} />
                Request for Information (RFI)
              </a>
            </div>
          </CardBody>
        </Card>
        <Card shadow="sm">
          <CardHeader>
            <div class="resource-card-header p-2">
              <h3 class="resource-card-title">Enhancing the Safety of Vulnerable Road Users at Intersections</h3>
              <p class="resource-card-subtitle">DOT Webinar | March 17, 2023</p>
            </div>
          </CardHeader>
          <CardBody>
            <div class="p-2 d-flex gap-2">
              <a 
                class="resource-button" 
                href={base_url("/assets/intersection-safety/Intersection_Safety_Webinar.pdf")} 
                rel="noopener noreferrer" 
                target="_blank"
              >
                <PdfIcon size={12}/>
                Presentation Material
              </a>
              <a 
                class="resource-button" 
                href="https://itsa.adobeconnect.com/pzkh0m71kitt/" 
                rel="noopener noreferrer" 
                target="_blank"
              >
                <FilmIcon size={12} />
                Recording
              </a>
            </div>
          </CardBody>
        </Card>
      </div>
    </ProgramSection>
  </main>
</Layout>